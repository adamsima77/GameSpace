import{_ as f,c as o,b as a,i as y,h as i,j as n,v as d,q as b,F as c,e as h,a as v,o as r,t as g,s as _}from"./index-DioUgQHd.js";const k={data(){return{name:"",price:"",main_desc:"",alt:"",html_desc:"",release_date:"",platform:[],subcategory:[],main_category:null,picture:null,current_image:"",res:{all_main_categories:[],all_platforms:[],all_subcategories:[]}}},methods:{handleFileUpload(t){this.picture=t.target.files[0]},async fetchCategoriesPlatforms(){try{const e=(await this.$axios.get("http://localhost/GameSpace/endpoints/fetch/fetchAddItems.php",{withCredentials:!1})).data;this.res.all_main_categories=e.all_main_categories||[],this.res.all_platforms=e.all_platforms||[]}catch{}},async add(){try{const t=new FormData;t.append("id",this.$route.params.id),t.append("img",this.picture),t.append("name",this.name),t.append("price",this.price),t.append("description",this.main_desc),t.append("alt",this.alt),t.append("html_desc",this.html_desc),t.append("release_date",this.release_date),this.platform.forEach(p=>t.append("platforms[]",p)),this.subcategory.forEach(p=>t.append("subcategories[]",p)),t.append("main_category",this.main_category);const e=await this.$axios.post("http://localhost/GameSpace/endpoints/add/add_item.php",t,{headers:{"Content-Type":"multipart/form-data"}});e.data.message==="success"?(alert("Záznam bol úspešne pridaný !"),this.clean()):alert(e.data.message)}catch{}},clean(){this.name="",this.price="",this.main_desc="",this.alt="",this.release_date="",this.html_desc="",this.main_category=null,this.subcategory=[],this.platform=[],this.picture=null,this.current_image="",tinymce.get("html_desc")&&tinymce.get("html_desc").setContent("")},async fetchSubcategories(t){try{const e=await this.$axios.get("http://localhost/GameSpace/endpoints/fetch/fetch_subcategory_add.php",{params:{category:t},withCredentials:!1});this.res.all_subcategories=e.data}catch{}}},mounted(){tinymce.init({selector:"#html_desc",height:600,plugins:"lists link table code",toolbar:"undo redo | bold italic | bullist numlist | link | code",setup:t=>{t.on("init",()=>{this.html_desc&&t.setContent(this.html_desc)}),t.on("change keyup",()=>{this.html_desc=t.getContent()})}}),this.fetchCategoriesPlatforms()},beforeUnmount(){tinymce.get("html_desc")&&tinymce.get("html_desc").remove()},watch:{main_category(t){t?this.fetchSubcategories(t):(this.res.all_subcategories=[],this.subcategory=[])}}},x={class:"wrapper"},C={class:"wrapp"},U={for:"name"},w={for:"price"},V={for:"main_desc"},S={for:"img"},F={for:"alt"},I={for:"release_date"},M={for:"main_category"},N=["value"],P={class:"checkboxes"},D=["value"],T={class:"checkboxes"},z=["value"],B={key:0};function E(t,e,p,G,l,m){return r(),o("div",x,[a("div",C,[e[21]||(e[21]=a("h1",null,"Pridať produkt",-1)),a("form",{onSubmit:e[9]||(e[9]=y((...s)=>m.add&&m.add(...s),["prevent"]))},[a("label",U,[e[10]||(e[10]=i("Názov ",-1)),n(a("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=s=>l.name=s)},null,512),[[d,l.name]])]),a("label",w,[e[11]||(e[11]=i("Cena: ",-1)),n(a("input",{type:"text","onUpdate:modelValue":e[1]||(e[1]=s=>l.price=s)},null,512),[[d,l.price]])]),a("label",V,[e[12]||(e[12]=i("Hlavný popis: ",-1)),n(a("textarea",{"onUpdate:modelValue":e[2]||(e[2]=s=>l.main_desc=s)},null,512),[[d,l.main_desc]])]),a("label",S,[e[13]||(e[13]=i("Image: ",-1)),a("input",{type:"file",onChange:e[3]||(e[3]=(...s)=>m.handleFileUpload&&m.handleFileUpload(...s))},null,32)]),a("label",F,[e[14]||(e[14]=i("Image alt: ",-1)),n(a("input",{type:"text","onUpdate:modelValue":e[4]||(e[4]=s=>l.alt=s)},null,512),[[d,l.alt]])]),a("label",I,[e[15]||(e[15]=i("Dátum vydania: ",-1)),n(a("input",{type:"date","onUpdate:modelValue":e[5]||(e[5]=s=>l.release_date=s)},null,512),[[d,l.release_date]])]),e[19]||(e[19]=a("label",{for:"html_desc"},[i("HTML popis: "),a("textarea",{id:"html_desc"})],-1)),a("label",M,[e[16]||(e[16]=i(" Hlavná kategória: ",-1)),n(a("select",{id:"main_category","onUpdate:modelValue":e[6]||(e[6]=s=>l.main_category=s)},[(r(!0),o(c,null,h(l.res.all_main_categories,s=>(r(),o("option",{value:s.idCategory,key:s.idCategory},g(s.name),9,N))),128))],512),[[b,l.main_category]])]),a("label",null,[e[17]||(e[17]=i("Platformy: ",-1)),a("div",P,[(r(!0),o(c,null,h(l.res.all_platforms,s=>(r(),o("div",{key:s.platform_id},[n(a("input",{type:"checkbox",value:s.platform_id,"onUpdate:modelValue":e[7]||(e[7]=u=>l.platform=u)},null,8,D),[[_,l.platform]]),i(" "+g(s.name),1)]))),128))])]),a("label",null,[e[18]||(e[18]=i("Subkategórie: ",-1)),a("div",T,[(r(!0),o(c,null,h(l.res.all_subcategories,s=>(r(),o("div",{key:s.idCategory},[n(a("input",{type:"checkbox",value:s.idCategory,"onUpdate:modelValue":e[8]||(e[8]=u=>l.subcategory=u)},null,8,z),[[_,l.subcategory]]),i(" "+g(s.name),1)]))),128)),l.res.all_subcategories.length===0?(r(),o("p",B,"Nebola zvolená hlavná kategória.")):v("",!0)])]),e[20]||(e[20]=a("input",{type:"submit",value:"Pridať produkt"},null,-1))],32)])])}const A=f(k,[["render",E],["__scopeId","data-v-bc0c1527"]]);export{A as default};
