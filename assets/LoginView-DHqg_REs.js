import{S,E as v}from"./Error-BfkMljii.js";import{_ as h,k as b,c as d,b as s,f as g,r as _,i as u,h as i,j as n,v as l,F as k,o as a}from"./index-CyFD_r_B.js";const E={data(){return{changeLayout:!1,login_email:"",login_password:"",register_name:"",register_surname:"",register_email:"",register_password:"",register_repeat_password:"",role:"1",res:{},resKey:0,userStore:null}},created(){this.userStore=b()},methods:{async createUser(){try{const o=await this.$axios.post("http://localhost/GameSpace/endpoints/add/register.php",{name:this.register_name,surname:this.register_surname,email:this.register_email,password:this.register_password,repeat_password:this.register_repeat_password,role:this.role,withCredentials:!1});this.res=o.data,this.resKey++,this.changeLayout=!1,this.login_email="",this.login_password="",this.register_name="",this.register_surname="",this.register_email="",this.register_password="",this.register_repeat_password=""}catch(o){this.res={status:"error",message:o.response?.data?.message||"SERVER_ERROR"},this.resKey++}window.scrollTo({top:0,behavior:"smooth"})},async loginUser(){try{const o=await this.$axios.post("http://localhost/GameSpace/endpoints/fetch/login_user.php",{email:this.login_email,password:this.login_password},{withCredentials:!0});this.res=o.data,this.resKey++,this.userStore.setName(this.res.name),this.userStore.setSurname(this.res.last_name),this.userStore.setEmail(this.res.email),this.userStore.setRole(this.res.role),this.userStore.setID(this.res.user_id),this.userStore.sessionChecked=!0,this.login_email="",this.login_password="",this.userStore.role===2?this.$router.push({name:"dashboard"}):this.userStore.role==1&&this.$router.push({name:"home"})}catch(o){this.res={status:"error",message:o.response?.data?.message||"SERVER_ERROR"},this.resKey++,this.$router.push("/login")}window.scrollTo({top:0,behavior:"smooth"})}},components:{Error:v,Success:S}},U={class:"message"},x={class:"wrapper"},R={for:"log_email"},V={for:"log_password"},L={class:"inputs"},C={for:"name"},K={for:"surname"},B={for:"email"},N={for:"password"},T={for:"repeat_password"};function j(o,e,w,f,r,p){const m=_("Error"),y=_("Success");return a(),d(k,null,[s("div",U,[(a(),g(m,{message:r.res,key:r.resKey},null,8,["message"])),(a(),g(y,{message:r.res,key:r.resKey},null,8,["message"]))]),s("div",x,[r.changeLayout?(a(),d("form",{key:1,method:"post",class:"register",onClick:e[11]||(e[11]=u(()=>{},["stop"])),onSubmit:e[12]||(e[12]=u((...t)=>p.createUser&&p.createUser(...t),["prevent"]))},[e[25]||(e[25]=s("h1",{style:{"text-align":"center"}},"Registrácia",-1)),s("div",L,[s("label",C,[e[18]||(e[18]=i("Meno: ",-1)),n(s("input",{type:"text",id:"name","onUpdate:modelValue":e[5]||(e[5]=t=>r.register_name=t),autocomplete:"on"},null,512),[[l,r.register_name]])]),s("label",K,[e[19]||(e[19]=i("Priezvisko: ",-1)),n(s("input",{type:"text",id:"surname","onUpdate:modelValue":e[6]||(e[6]=t=>r.register_surname=t),autocomplete:"on"},null,512),[[l,r.register_surname]])]),s("label",B,[e[20]||(e[20]=i("E-mail: ",-1)),n(s("input",{type:"email",id:"email","onUpdate:modelValue":e[7]||(e[7]=t=>r.register_email=t),autocomplete:"on"},null,512),[[l,r.register_email]])]),s("label",N,[e[21]||(e[21]=i("Heslo: ",-1)),n(s("input",{type:"password",id:"password","onUpdate:modelValue":e[8]||(e[8]=t=>r.register_password=t),autocomplete:"off"},null,512),[[l,r.register_password]])]),s("label",T,[e[22]||(e[22]=i("Zopakujte heslo: ",-1)),n(s("input",{type:"password",id:"repeat_password","onUpdate:modelValue":e[9]||(e[9]=t=>r.register_repeat_password=t),autocomplete:"off"},null,512),[[l,r.register_repeat_password]])]),s("p",null,[e[23]||(e[23]=i("Ste zaregistrovaný ? ",-1)),s("span",{onClick:e[10]||(e[10]=t=>r.changeLayout=!1)},"Prihláste sa")]),e[24]||(e[24]=s("input",{type:"submit"},null,-1))])],32)):(a(),d("div",{key:0,class:"login",onClick:e[4]||(e[4]=u(()=>{},["stop"]))},[e[17]||(e[17]=s("h1",{style:{"text-align":"center"}},"Prihlásenie",-1)),s("form",{method:"post",class:"inputs",onSubmit:e[3]||(e[3]=u((...t)=>p.loginUser&&p.loginUser(...t),["prevent"]))},[s("label",R,[e[13]||(e[13]=i("E-mail: ",-1)),n(s("input",{type:"email",id:"log_email","onUpdate:modelValue":e[0]||(e[0]=t=>r.login_email=t),required:""},null,512),[[l,r.login_email]])]),s("label",V,[e[14]||(e[14]=i("Heslo: ",-1)),n(s("input",{type:"password",id:"log_password","onUpdate:modelValue":e[1]||(e[1]=t=>r.login_password=t),required:""},null,512),[[l,r.login_password]])]),s("p",null,[e[15]||(e[15]=i("Nie ste zaregistrovaný ? ",-1)),s("span",{onClick:e[2]||(e[2]=t=>r.changeLayout=!0)},"Zaregistrujte sa")]),e[16]||(e[16]=s("input",{type:"submit"},null,-1))],32)]))])],64)}const z=h(E,[["render",j],["__scopeId","data-v-8894ead6"]]),M={components:{Login:z}};function P(o,e,w,f,r,p){const m=_("Login");return a(),g(m)}const F=h(M,[["render",P]]);export{F as default};
