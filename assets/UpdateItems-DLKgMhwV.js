import{_ as y,c as r,b as t,i as b,h as l,j as o,v as m,a as v,q as k,F as c,e as g,o as n,t as _,s as f}from"./index-DrA51BzS.js";const x={data(){return{name:"",price:"",main_desc:"",alt:"",html_desc:"",release_date:"",current_image:"",res:{},platform:[],subcategories:[],subcategory:[],main_category:"",picture:null}},methods:{handleFileUpload(a){this.picture=a.target.files[0]},async fetchActual(){try{const a=await this.$axios.get("http://localhost/GameSpace/endpoints/fetch/fetch_item_edit.php",{params:{id:this.$route.params.id},withCredentials:!1});this.res=a.data,this.name=this.res.item.name,this.price=this.res.item.price,this.main_desc=this.res.item.description,this.alt=this.res.item.alt,this.current_image=this.res.item.image,this.release_date=this.res.item.release_date,this.html_desc=this.res.item.html_description,this.main_category=this.res.item.main_category,this.subcategories=this.res.subcategories,this.subcategory=this.res.subcategories.map(e=>e.idCategory),this.platform=this.res.platforms.map(e=>e.platform_id),tinymce.init({selector:"#html_desc",height:600,plugins:"lists link table code",toolbar:"undo redo | bold italic | bullist numlist | link | code",setup:e=>{e.on("init",()=>{this.html_desc&&e.setContent(this.html_desc)}),e.on("change keyup",()=>{this.html_desc=e.getContent()})}})}catch{}},async update(){try{const a=new FormData;a.append("id",this.$route.params.id),a.append("img",this.picture),a.append("name",this.name),a.append("price",this.price),a.append("description",this.main_desc),a.append("alt",this.alt),a.append("html_desc",this.html_desc),a.append("release_date",this.release_date),this.platform.forEach(d=>a.append("platforms[]",d)),this.subcategory.forEach(d=>a.append("subcategories[]",d)),a.append("main_category",this.main_category);const e=await this.$axios.post("http://localhost/GameSpace/endpoints/update/update_item.php",a,{headers:{"Content-Type":"multipart/form-data"}});e.data.message==="success"?(alert("Záznam bol úspešne upravený !"),this.fetchActual()):alert(e.data.message)}catch{}}},mounted(){this.fetchActual(),document.title=this.$route.params.id},beforeUnmount(){tinymce.get("html_desc")&&tinymce.get("html_desc").remove()}},U={class:"wrapper"},C={class:"wrapp"},V={for:"name"},w={for:"price"},F={for:"main_desc"},S={for:"img"},M=["src"],A={for:"alt"},D={for:"release_date"},I={for:"main_category"},N=["value"],T={class:"checkboxes"},B=["value"],E={class:"checkboxes"},H=["value"];function z(a,e,d,G,i,u){return n(),r("div",U,[t("div",C,[e[22]||(e[22]=t("h1",null,"Upraviť produkt",-1)),t("form",{method:"post",onSubmit:e[9]||(e[9]=b((...s)=>u.update&&u.update(...s),["prevent"]))},[t("label",V,[e[10]||(e[10]=l("Názov ",-1)),o(t("input",{type:"text",id:"name","onUpdate:modelValue":e[0]||(e[0]=s=>i.name=s)},null,512),[[m,i.name]])]),t("label",w,[e[11]||(e[11]=l("Cena: ",-1)),o(t("input",{type:"text",name:"price",id:"price","onUpdate:modelValue":e[1]||(e[1]=s=>i.price=s)},null,512),[[m,i.price]])]),t("label",F,[e[12]||(e[12]=l("Hlavný popis: ",-1)),o(t("textarea",{name:"main_desc",id:"main_desc","onUpdate:modelValue":e[2]||(e[2]=s=>i.main_desc=s)},null,512),[[m,i.main_desc]])]),t("label",S,[e[13]||(e[13]=l("Image: ",-1)),t("input",{type:"file",name:"img",id:"img",onChange:e[3]||(e[3]=(...s)=>u.handleFileUpload&&u.handleFileUpload(...s))},null,32),e[14]||(e[14]=t("p",{class:"prev"},"Aktuálna fotka:",-1)),i.current_image?(n(),r("img",{key:0,src:i.current_image,class:"preview"},null,8,M)):v("",!0)]),t("label",A,[e[15]||(e[15]=l("Image alt: ",-1)),o(t("input",{type:"text",name:"alt",id:"alt","onUpdate:modelValue":e[4]||(e[4]=s=>i.alt=s)},null,512),[[m,i.alt]])]),t("label",D,[e[16]||(e[16]=l("Dátum vydania: ",-1)),o(t("input",{type:"date",name:"release_date",id:"release_date","onUpdate:modelValue":e[5]||(e[5]=s=>i.release_date=s)},null,512),[[m,i.release_date]])]),e[20]||(e[20]=t("label",{for:"html_desc"},[l("HTML popis: "),t("textarea",{id:"html_desc"})],-1)),t("label",I,[e[17]||(e[17]=l("Hlavná kategória: ",-1)),o(t("select",{id:"main_category","onUpdate:modelValue":e[6]||(e[6]=s=>i.main_category=s)},[(n(!0),r(c,null,g(i.res.all_main_categories,(s,p)=>(n(),r("option",{value:s.idCategory,key:p},_(s.name),9,N))),128))],512),[[k,i.main_category]])]),t("label",null,[e[18]||(e[18]=l("Platformy: ",-1)),t("div",T,[(n(!0),r(c,null,g(i.res.all_platforms,(s,p)=>(n(),r("div",{key:p},[o(t("input",{type:"checkbox",value:s.platform_id,"onUpdate:modelValue":e[7]||(e[7]=h=>i.platform=h)},null,8,B),[[f,i.platform]]),l(" "+_(s.name),1)]))),128))])]),t("label",null,[e[19]||(e[19]=l("Subkategórie: ",-1)),t("div",E,[(n(!0),r(c,null,g(i.res.all_subcategories,(s,p)=>(n(),r("div",{key:p},[o(t("input",{type:"checkbox",value:s.idCategory,"onUpdate:modelValue":e[8]||(e[8]=h=>i.subcategory=h)},null,8,H),[[f,i.subcategory]]),l(" "+_(s.name),1)]))),128))])]),e[21]||(e[21]=t("input",{type:"submit",value:"Upraviť produkt"},null,-1))],32)])])}const j=y(x,[["render",z],["__scopeId","data-v-1357ee11"]]);export{j as default};
